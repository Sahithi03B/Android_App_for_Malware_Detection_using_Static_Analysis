package com.example.spyware4;

import android.content.Intent;
import android.content.pm.ResolveInfo;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import androidx.appcompat.app.AppCompatActivity;

import java.util.List;

public class AboutActivity extends AppCompatActivity {

    private ListView appsListView;
    private List<ResolveInfo> installedApps;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_about);

        appsListView = findViewById(R.id.appsListView);

        installedApps = getInstalledApps();

        // Create an adapter for the list of apps
        ArrayAdapter<String> appsAdapter = new ArrayAdapter<>(this, android.R.layout.simple_list_item_1, getAppNames(installedApps));
        appsListView.setAdapter(appsAdapter);

        // Set up the click event to launch the selected app
        appsListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
                ResolveInfo selectedAppInfo = installedApps.get(position);
                launchApp(selectedAppInfo);
            }
        });
    }

    private List<ResolveInfo> getInstalledApps() {
        // Get the list of installed packages on the device
        Intent intent = new Intent(Intent.ACTION_MAIN, null);
        intent.addCategory(Intent.CATEGORY_LAUNCHER);

        return getPackageManager().queryIntentActivities(intent, 0);
    }

    private void launchApp(ResolveInfo resolveInfo) {
        // Launch the selected app
        Intent launchIntent = getPackageManager().getLaunchIntentForPackage(resolveInfo.activityInfo.packageName);
        if (launchIntent != null) {
            startActivity(launchIntent);
        }
    }

    private String[] getAppNames(List<ResolveInfo> apps) {
        String[] appNames = new String[apps.size()];
        for (int i = 0; i < apps.size(); i++) {
            appNames[i] = apps.get(i).loadLabel(getPackageManager()).toString();
        }
        return appNames;
    }
}


